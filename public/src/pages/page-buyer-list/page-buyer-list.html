<link rel="import" href="./../../../bower_components/polymer/polymer.html">
<link rel="import" href="./../../layout/page-style.html">
<link rel="import" href="components/buyer-list.html">
<link rel="import" href="./../../../bower_components/nylon-panel/nylon-panel-right.html">
<link rel="import" href="./../../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="./../../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="./../page-contract-list/components/contract-detail.html">
<link rel="import" href="./../../layout/shared-styles.html">


<dom-module id="page-buyer-list">
    <template>
        <style include="page-style shared-styles">
             :host {
                --paper-fab-background: var(--paper-light-blue-500);
                --paper-fab-keyboard-focus-background: var(--paper-light-blue-900);
            }

            * {
                font-family: 'CSChatThaiUI', sans-serif;
                -webkit-font-smoothing: antialiased;
            }

            nylon-panel-right {
                --app-toolbar-style: {
                    background-color: #FF5000;
                }
            }
        </style>
        <div class="layout vertical">
            <div class="xx horizontal center-justified layout wrap" style="width: 1300px">
                <template is="dom-repeat" items={{buyerList}} index-as=index>
                    <buyer-list data="[[item]]"></buyer-list>
                </template>
            </div>
        </div>
        <nylon-panel-right title="{{titlePanelRight}}" id="drawerRight" set-width="95%">
            <div class="rightdata" align="left">
                <contract-detail></contract-detail>
            </div>
        </nylon-panel-right>
        <div class="btnFab">
            <paper-fab icon="add" title="[[localizeContract.add_contract]]" id="addCountry" on-tap="addCountry"></paper-fab>
            <paper-tooltip for="addCountry" offset="0">[[localizeContract.add_contract]]</paper-tooltip>
        </div>

    </template>
    <script>
        Polymer({
            is: 'page-buyer-list',
            behaviors: [ReduxBehavior, nylonBehavior, i18nAction, contractAction, commonG2gAction,
                commonStateAction],
            properties: {
                titlePanelRight: {
                    type: String,
                    value: 'การซื้อขายข้าวระหว่างประเทศ'
                },
                buyerList: {
                    statePath: 'contract.buyerList'
                },
                localizeContract: {
                    statePath: 'i18n.contract'
                },
            },
            listeners: {
                'close-drawer': '_flipDrawerClose',
            },
            nylonPageActive: function () {

                this.dispatchAction('GET_BUYER_LIST');

                this.dispatchAction('GET_COMMON_HAMONIZE_LIST');
                this.dispatchAction('GET_COMMON_HAMONIZE_LIST_NO_GROUP');
                this.dispatchAction('GET_COMMON_BUYER_LIST');
            },
            addCountry() {
                this.titlePanelRight = this.localizeContract.add_contract
                this.dispatchAction('CLEAR_CONTRACT')
                this.dispatchAction('SET_STATE', {
                    isInsert: true,
                    btnDisabled: false,
                    hiddend: true
                })
                this.fire('toast', { status: 'load' });
                this.async(() => {
                    this.fire('toast', {
                        status: 'success', text: this.localizeContract.load_success, callback: () => {
                            this._flipDrawer();
                        }
                    })

                }, 500)

            },
            _flipDrawer: function () {
                Polymer.dom(this.root).querySelector('#drawerRight').open();
            },
            _flipDrawerClose: function () {
                Polymer.dom(this.root).querySelector('#drawerRight').close();
            }
        });
    </script>
</dom-module>