<link rel="import" href="./../../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="./../../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="./../../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="./../../../bower_components/nylon-panel/nylon-panel-right.html">
<link rel="import" href="./components/manage-report.html">
<link rel="import" href="./components/list-report.html">
<link rel="import" href="./../../layout/shared-styles.html">

<dom-module id="page-report">
    <template>
        <style include="shared-styles">
             :host {
                font-family: CSChatThaiUI;
                --paper-fab-background: var(--paper-light-blue-500);
                --paper-fab-keyboard-focus-background: var(--paper-light-blue-900);
            }

            .title {
                margin: 30px;
                font-size: 36px;
            }

            .btnFabBack>paper-fab {
                left: 25px;
                --paper-fab-iron-icon: {
                    color: black
                }
                ;
                --paper-fab-background: #fff
                /*--paper-fab-background: #fff;*/
            }
        </style>

        <div class="xcontainer">
            <div class="title">
                [[localizeReport.report]]
            </div>
            <div class="container">
                <list-report></list-report>
            </div>
        </div>
        <nylon-panel-right title="[[localizeReport.report]]" id="drawerRight" set-width="95%">
            <div align="left">
                <manage-report></manage-report>
            </div>
        </nylon-panel-right>
        <div class="btnFabBack">
            <paper-fab icon="arrow-back" title="[[localizeReport.back]]" id="backWard" on-tap="backPage"></paper-fab>
            <paper-tooltip for="addContract" offset="0">[[localizeReport.back]]</paper-tooltip>
        </div>
        <div class="btnFab">
            <paper-fab icon="note-add" title="[[localizeReport.add_report]]" id="addReport" on-tap="addReport"></paper-fab>
            <paper-tooltip for="addReport" offset="0">[[localizeReport.add_report]]</paper-tooltip>
        </div>
    </template>
    <script>
        Polymer({
            is: 'page-report',
            behaviors: [ReduxBehavior, nylonBehavior, CookieBehavior, i18nAction, commonStateAction, reportAction],
            properties: {
                localizeReport: {
                    statePath: 'i18n.report'
                },
            },
            listeners: {
                'open-Drawer': '_flipDrawer',
                'close-drawer': '_flipDrawerClose',
            },
            nylonPageActive: function () {
                this.dispatchAction('SET_BUYER_ID', {
                    buyer_id: this.getCookieBhv("buyerId")
                })
                this.dispatchAction('GET_REPORT_LIST')
                this.dispatchAction('GET_TABLE_LIST')
                // this.dispatchAction('SET_COUNTRY_NAME_EN', this.getCookieBhv("country_name_en"));
            },
            backPage: function () {
                // console.log(11111);
                // console.log(this.$$('#tab7').checked);
                this.fire('nylon-change-page', { path: '/buyer-list' })
            },
            addReport: function () {
                this.dispatchAction('SET_STATE', {
                    isInsert: true,
                    btnDisabled: false,
                    hiddend: true
                })
                this.dispatchAction('SET_REPORT_DETAIL')
                this.fire('toast', { status: 'load' });
                this.async(() => {
                    this.fire('toast', {
                        status: 'success', text: 'โหลดสำเร็จ', callback: () => {
                            this._flipDrawer();
                        }
                    })

                }, 500)
                // this._flipDrawer()
            },
            _flipDrawer: function () {
                Polymer.dom(this.root).querySelector('#drawerRight').open();
            },
            _flipDrawerClose: function () {
                Polymer.dom(this.root).querySelector('#drawerRight').close();
            },
            // urlToReport(e) {
            //     window.open('./api' + e.currentTarget.data.path)
            // },
            // _print: function () {
            //     this.$$('#report').open()

            // },
            // printReport() {
            //     this.data
            //     window.open('./api/report/daily/company?date=' + this.data)
            // }
        });
    </script>
</dom-module>