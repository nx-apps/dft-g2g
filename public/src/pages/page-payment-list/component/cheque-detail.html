<!--<link rel="import" href="cheque-detail-invoice.html">-->
<link rel="import" href="./../../../../bower_components/gl-form/gl-form-input.html">
<link rel="import" href="./../../../../bower_components/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="./../../../../bower_components/gl-form/gl-form-panel.html">
<link rel="import" href="./../../../../bower_components/gl-grid/gl-grid-row.html">
<link rel="import" href="./../../../../bower_components/gl-grid/gl-grid-col.html">

<dom-module id="cheque-detail">
  <style include="iron-flex iron-flex-factors iron-flex-alignment gl-styles">
     :host {
      display: block;
    }

     :host {
      display: block;
    }

    table.gl-table-default {
      width: 98%;
      border: 1px solid #ddd;
      margin-bottom: 15px;
    }

    table.gl-table-default>thead.table-head>tr>th,
    table.gl-table-default>tbody.table-body>tr>td,
    table.gl-table-default>thead.table-head>tr>th {
      text-align: center;
    }

    table.gl-table-default>tbody.table-body>tr>td:nth-child(2),
    table.gl-table-default>tbody.table-body>tr>td:nth-child(3) {
      text-align: left;
    }



    vaadin-date-picker {
      margin-top: -27px;
    }
  </style>
  <template>
    <gl-form-panel set-padding="10px 20px 10px 20px" set-border="1px">
      <!--<template is="dom-repeat" items="[[data]]">-->
      <!--<div class="gl-panel-default">-->
      <div class="horizontal center-justified layout" style="overflow-x:auto;">
        <table class="gl-table-default">
          <thead class="table-head">
            <tr>
              <th style="width: 50px;">
                <paper-checkbox on-tap="_selectDataAll" checked="{{selectDataAll}}"></paper-checkbox>{{localize.select}}</th>
              </th>
              <th style="width: 70px">งวดที่</th>
              <th style="width: 70px;">ครั้งที่</th>
              <th style="width: 70px;">รอบ</th>
              <th style="width: 240px;">บริษัท</th>
              <th style="width: 170px;">จำนวนเงิน</th>
              <th style="width: 140px;">เลขที่ Invoice</th>
              <th style="width: 140px;">วันที่ Invoice</th>
              <th style="width: 180px">เลขที่เช็ค</th>
            </tr>
            </tr>
          </thead>
          <tbody class="table-body">
            <template is="dom-repeat" items="[[data]]">
              <tr style="{{checkStatus(item.status)}}">
                <td>
                  <paper-checkbox data="{{item}}" checked="{{item.check}}" disabled="{{item.status}}" on-tap="setNoCheque"></paper-checkbox>
                </td>
                <td>[[item.fee]]</td>
                <td>[[item.fee_no]]</td>
                <td>[[item.fee_round]]</td>
                <td>[[item.company]] </td>
                <td>[[item.value_b]] </td>
                <td>
                  <gl-form-input placeholder="เลบที่ invoice" no-label-float value="{{item.invoice_exporter_no}}" data="[[item]]" on-blur="updateCheque"></gl-form-input>
                </td>
                <td>
                  <gl-form-input type="date" placeholder="วันที่" no-label-float value="{{item.invoice_exporter_date}}" data="[[item]]"></gl-form-input>
                </td>
                <td>
                  <gl-form-input placeholder="invoice" no-label-float value="{{item.invoice_no}}" data="[[item]]"></gl-form-input>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
      <div class="btnMoney horizontal end-justified layout">
        <paper-button class="gl-btn-success" raised on-tap="getChequeDetail">ขึ้นเช็ค</paper-button>
      </div>
      <!--</template>-->
    </gl-form-panel>
  </template>
  <script>
    Polymer({
      is: "cheque-detail",
      behaviors: [ReduxBehavior],
      properties: {
        localize: {
          statePath: 'i18n.g2g'
        },
        no: {
          type: Number,
          value: 1120
        },
        data: {
          type: Array,
          value: [
            {
              check: false,
              status: false,
              fee: 1,
              fee_no: 1,
              fee_round: 1,
              company: 'ขายข้าว 1 จำกัด',
              value_b: 100,
              invoice_exporter_no: '',
              invoice_exporter_date: '',
              invoice_no: ''
            },
            {
              check: false,
              status: false,
              fee: 1,
              fee_no: 1,
              fee_round: 1,
              company: 'ขายข้าว 1 จำกัด',
              value_b: 100,
              invoice_exporter_no: '',
              invoice_exporter_date: '',
              invoice_no: ''
            },
            {
              check: false,
              status: true,
              fee: 1,
              fee_no: 1,
              fee_round: 1,
              company: 'ขายข้าว 1 จำกัด',
              value_b: 100,
              invoice_exporter_no: '',
              invoice_exporter_date: '',
              invoice_no: ''
            },
            {
              check: false,
              status: false,
              fee: 1,
              fee_no: 1,
              fee_round: 1,
              company: 'ขายข้าว 1 จำกัด',
              value_b: 100,
              invoice_exporter_no: '',
              invoice_exporter_date: '',
              invoice_no: ''
            },


          ]
        }
      },
      _selectDataAll: function (val) {
        try {
          this.data.map((item, index) => {
            this.set('data.' + index + '.check', this.selectDataAll);
          });
        } catch (error) {

        }
      },
      checkStatus: function (status) {
        if (status) return 'background-color: #F1F1F1;'
        return ''
        // console.log(status)
      },
      _selectDataAll: function (val) {
        try {
          this.data.map((item, index) => {
            if (item.status === false)
              this.set('data.' + index + '.check', this.selectDataAll);
          });
        } catch (error) {

        }
      },
      setNoCheque: function (para) {
        console.log(para.model.__data__)
        let item = para.model.__data__
        if (item.item.check === false) {
          this.set('data.' + item.index + '.invoice_no', '')
        } else {
          for (var index = 0; index < this.data.length; index++) {
              console.log(this.data[index].invoice_no);
            
          }
          // this.set('data.' + item.index + '.invoice_no', this.no)
        }
        console.log(this.no)

      },
    });
  </script>
</dom-module>